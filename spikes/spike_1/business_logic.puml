@startuml spike_1_business_logic

title Spike 1: SVG Rendering Pipeline Business Logic

skinparam BoxPadding 10

package "manim_devops.assets" {
    
    class SVGPreprocessor {
        + string temp_dir
        __
        + validate_input_svg(filepath: Path) : bool
        + sanitize_svg_for_manim(filepath: Path) : Path
        - remove_xml_namespaces(content: string) : string
        - extract_inline_css_to_attributes(content: string) : string
    }

    class DevopsSVGMobject {
        + Path original_filepath
        + Path sanitized_filepath
        + SVGMobject manim_mobject
        __
        + __init__(filepath: Path)
        + render() : SVGMobject
    }

}

note right of manim_devops.assets.SVGPreprocessor::sanitize_svg_for_manim
  1. Reads original SVG.
  2. Strips `<style>` blocks and `<defs>` if Manim incompatible.
  3. Writes cleaned SVG to a temporary directory.
  4. Returns the path to the cleaned SVG.
end note

note right of manim_devops.assets.DevopsSVGMobject::render
  Passes the sanitized_filepath into 
  Manim's native SVGMobject class.
  Returns a valid rendering object.
end note

manim_devops.assets.SVGPreprocessor <.. manim_devops.assets.DevopsSVGMobject : uses

@enduml
